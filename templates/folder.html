{% extends "base.html" %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <h1 class="h3 mb-0" style="color: var(--netflix-white); font-weight: 700;">{{ folder['name'] }}</h1>
  <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary btn-sm" style="font-weight: 500;">‚Üê Back to Dashboard</a>
</div>

<div class="row g-4">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <h2 class="h5 mb-4" style="color: var(--netflix-white); font-weight: 600;">Add New Question</h2>
        <form method="post">
          <div class="row g-4">
            <div class="col-12 col-lg-6">
              <div class="mb-3">
                <label for="title" class="form-label">Que title (required)</label>
                <input id="title" name="title" class="form-control" placeholder="Enter your question title" required />
              </div>

              <div class="mb-3">
                <label for="description" class="form-label">Que description</label>
                <textarea id="description" name="description" class="form-control" rows="4" placeholder="Describe your question in detail (optional)"></textarea>
              </div>

              <div class="mb-3">
                <label for="links" class="form-label">Links (one per line)</label>
                <textarea id="links" name="links" class="form-control" rows="4" placeholder="Add reference links, one per line (optional)"></textarea>
              </div>

              <div class="mb-3">
                <label for="notes" class="form-label">Notes</label>
                <textarea id="notes" name="notes" class="form-control" rows="4" placeholder="Add any additional notes (optional)"></textarea>
              </div>
            </div>

            <div class="col-12 col-lg-6">
              <div class="mb-3">
                <label for="code" class="form-label">Code section</label>
                <textarea id="code" name="code" class="form-control" rows="12" placeholder="Paste your code here (optional)" style="font-family: 'Courier New', monospace;"></textarea>
              </div>
              <div class="mb-3">
                <label for="terminal_output" class="form-label">Terminal</label>
                <textarea id="terminal_output" name="terminal_output" class="form-control" rows="4" placeholder="Paste terminal output here (optional)" style="font-family: 'Courier New', monospace; background: #1a1a1a; color: var(--netflix-white);"></textarea>
              </div>
            </div>
          </div>

          <div class="text-center mt-4">
            <button class="btn btn-primary py-2 px-4" style="font-weight: 600; font-size: 1.1rem;">Add Question</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-6">
    <div class="card">
      <div class="card-body">
        <h2 class="h5 mb-4" style="color: var(--netflix-white); font-weight: 600;">Your Questions</h2>
        {% if questions %}
          <div class="list-group">
            {% for q in questions %}
              <div class="list-group-item" style="border-radius: 8px; margin-bottom: 8px; padding: 0;">
                <div class="d-flex w-100 justify-content-between align-items-start">
                  <a href="{{ url_for('question_detail', question_id=q['id']) }}" class="text-decoration-none flex-grow-1" style="padding: 16px;">
                    <h3 class="h6 mb-2" style="color: var(--netflix-white); font-weight: 600;">{{ q['title'] }}</h3>
                    {% if q['description'] %}
                      <p class="mb-0 text-muted" style="font-size: 0.9rem; line-height: 1.4;">{{ q['description'][:140] }}{% if q['description']|length > 140 %}...{% endif %}</p>
                    {% endif %}
                  </a>
                  <div class="d-flex align-items-center" style="padding: 16px 16px 16px 0;">
                    <small class="text-muted me-3" style="font-size: 0.8rem;">{{ q['created_at'] | replace('T',' ') | replace('Z','') }}</small>
                    <button type="button" class="btn btn-outline-danger btn-sm" 
                            onclick="confirmDeleteQuestion('{{ q['id'] }}', '{{ q['title'] }}')"
                            title="Delete question">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3,6 5,6 21,6"></polyline>
                        <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-center py-4">
            <p class="text-muted mb-0" style="font-size: 1.1rem;">No questions yet.</p>
            <p class="text-muted" style="font-size: 0.9rem;">Add your first question to get started!</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<!-- Delete Question Confirmation Modal -->
<div class="modal fade" id="deleteQuestionModal" tabindex="-1" aria-labelledby="deleteQuestionModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteQuestionModalLabel">Delete Question</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete the question "<span id="questionName"></span>"?</p>
        <p class="text-danger"><strong>Warning:</strong> This will permanently delete the question and any associated files. This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <form id="deleteQuestionForm" method="post" style="display: inline;">
          <button type="submit" class="btn btn-danger">Delete Question</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
function confirmDeleteQuestion(questionId, questionTitle) {
  document.getElementById('questionName').textContent = questionTitle;
  document.getElementById('deleteQuestionForm').action = '/questions/' + questionId + '/delete';
  
  var deleteQuestionModal = new bootstrap.Modal(document.getElementById('deleteQuestionModal'));
  deleteQuestionModal.show();
}
</script>
{% endblock %}
